class FakeDataGeneratorService
  MOVIE_DATA = [
    {
      name: 'Avengers 4: Endgame',
      description: 'Biệt Đội Siêu Anh Hùng 4: Tàn Cuộc (Avengers 4: Endgame) ra mắt vào tháng 4/2019 sẽ giải quyết triệt để những khúc mắc đã vạch ra suốt 22 bộ phim trước đó của Vụ trụ điện ảnh Marvel (MCU). Hai tháng sau đó, Người Nhện 2 là khởi đầu hoàn toàn mới dành cho MCU. Sau sự kiện Thanos làm cho một nửa vũ trụ tan biến và khiến cho biệt đội Avengers thảm bại, những siêu anh hùng sống sót phải tham gia trận chiến cuối cùng trong Avengers: Endgame.',
      trailer_url: 'https://www.youtube.com/watch?v=JsTxPRKo5Bw',
      actress: [
        'Chris Evans',
        'Robert Downey, Jr.',
        'Mark Ruffalo',
        'Chris Hemsworth',
        'Scarlett Johansson'
      ],
      genre: [
        'Phim hành động', 'Phim viễn tưởng', 'Phim phiêu lưu', 'Phim chiếu rạp', 'Phim thuyết minh', 'Phim lẻ'
      ]
    },
    {
      name: 'Shazam!',
      description: 'Tất cả chúng ta đều là người hùng, vấn đề ở chỗ chúng ta phải biết cách phát huy năng lực của mình. Trong trường hợp của Bill Batson (Angel), với sự giúp đỡ của một phù thủy cổ xưa, chỉ cần nói lớn từ “Shazam!” là đứa trẻ 14 tuổi này có thể biến thành siêu anh hùng Shazam trưởng thành (Levi). Nhưng bên trong thân hình như một vị thần đó vẫn là trái tim của một đứa trẻ. Cái tên Shazam được dựa trên chữ cái đầu của những vị thần dũng mãnh là Solomon, Hercules, Atlas, Zeus, Achilles cùng Mercury.',
      trailer_url: 'https://www.youtube.com/watch?v=845gXO0tfLM',
      actress: [
        'Zachary Levi',
        'Mark Strong',
        'Adam Brody'
      ],
      genre: [
        'Phim hành động', 'Phim viễn tưởng', 'Phim phiêu lưu', 'Phim chiếu rạp', 'Phim thuyết minh', 'Phim lẻ', 'Phim hài hước'
      ]
    },
    {
      name: 'Pokémon: Detective Pikachu',
      description: 'Pokemon: Detective Pikachu xoay quay hành trình truy tìm manh mối phá án về cái chết của Harry Goodman – thám tử mẫn cán ở thành phố Ryme của Tim Goodman và người bạn đồng hành siêu đáng yêu Pikachu. Là người duy nhất nghe được giọng nói thực của của Pikachu thay vì tiếng “Pika Pika” quen thuộc, Tim và Pikachu nhanh chóng trở thành bạn thân và cùng dấn thân vào cuộc điều tra những vụ mất tích bí ẩn trong thành phố. Trong hành trình phá án, cặp đôi “oan gia” này đã gây ra những tình huống trái ngang nhưng tràn đầy tiếng cười.',
      trailer_url: 'https://www.youtube.com/watch?v=4iSmIsXVlmM',
      actress: [
        'Ryan Reynolds',
        'Justice Smith',
        'Kathryn Newton',
        'Bill Nighy',
        'Ken Watanabe'
      ],
      genre: [
        'Phim hành động', 'Phim viễn tưởng', 'Phim phiêu lưu', 'Phim hài hước', 'Phim Bí ẩn-Siêu nhiên', 'Phim gia đình', 'Phim chiếu rạp', 'Phim thuyết minh', 'Phim lẻ'
      ]
    },
    {
      name: 'How to Train Your Dragon 3: The Hidden World',
      description: 'Sau khi Hiccup tạo ra một thế giới hòa bình cho loài rồng, Răng Sún phát hiện ra một người bạn mới đầy bí hiểm. Lúc này Hiccup đã trở thành người lãnh đạo của cả làng gánh trên vai trọng trách gìn giữ sự an nguy cho mọi người. Vì vậy, cậu không thể mãi bị cuốn theo những cuộc phiêu lưu bất tận với Răng Sún. Và khi nguy hiểm ập đến ngôi làng, cả Hiccup và Răng Sún đều đã đứng lên, anh dũng bảo vệ giống loài của mình',
      trailer_url: 'https://www.youtube.com/watch?v=Siqw8k05D4g',
      actress: [
        'Jay Baruchel',
        'America Ferrera',
        'Cate Blanchett',
        'Gerard Butler'
      ],
      genre: [
        'Phim hành động', 'Phim viễn tưởng', 'Phim phiêu lưu', 'Phim hài hước', 'Phim gia đình', 'Phim chiếu rạp', 'Phim thuyết minh', 'Phim lẻ'
      ]
    },
    {
      name: 'Toy Story 4',
      description: 'Sự trở lại rất hào hứng của dàn đồ chơi quen thuộc như Woody, Buzz Lightyear, Jessie... cùng hai nhân vật mới sẽ xuất hiện trong Toy Story4: Ducky và Bunny!',
      trailer_url: 'https://www.youtube.com/watch?v=CjpegSt3Bzc',
      actress: [
        'Tom Hanks',
        'Tim Allen',
        'Annie Potts',
        'Tony Hale'
      ],
      genre: [
        'Phim viễn tưởng', 'Phim phiêu lưu', 'Phim hài hước', 'Phim gia đình', 'Phim chiếu rạp', 'Phim thuyết minh', 'Phim lẻ'
      ]
    },
    {
      name: 'Frozen',
      description: 'Có thể nhiều người sẽ ao ước sở hữu phép thuật, song đó chắc chắn không phải nàng công chúa Elsa. Ngay từ nhỏ, cô đã có khả năng kỳ diệu là tạo ra băng tuyết cũng như điều khiển những con gió. Nhưng chính khả năng ấy đã vô tình gây thương tích cho em gái Anna. Anna được các quỷ lùn chữa trị và cái giá phải trả là cô bé hoàn toàn quên mất việc chị mình có năng lực đặc biệt. Không những thế, đức vua và hoàng hậu còn phải cách ly Elsa trong căn phòng kín để phép thuật của cô không phát tác, khiến tuổi thơ hai chị em Elsa và Anna bị tách rời',
      trailer_url: 'https://www.youtube.com/watch?v=WLw9cPUkltc',
      actress: [
        'Kristen Bell',
        'Idina Menzel',
        'Jonathan Groff',
        'Josh Gad'
      ],
      genre: [
        'Phim viễn tưởng', 'Phim phiêu lưu', 'Phim hài hước', 'Phim gia đình', 'Phim chiếu rạp', 'Phim thuyết minh', 'Phim lẻ'
      ]
    }
  ].freeze

  def execute
    MOVIE_DATA.each do |item|
      m = Movie.new
      m.name = item[:name]
      m.description = item[:description]
      m.trailer_url = item[:trailer_url]
      item[:actress].each do |actress|
        act = save_actress actress
        m.actress << act
      end
      item[:genre].each do |genre|
        new_genre = save_genre genre
        m.genre << new_genre
      end
      m.save!
    end
  end

  private

  def save_actress(name)
    act = Actress.new
    act.name = name
    act.save!
    act.reload
    act
  end

  def save_genre(name)
    existed_genre = Genre.where(name: name).last
    genre = existed_genre
    if existed_genre.nil?
      g = Genre.new
      g.name = name
      g.save!
      g.reload
      genre = g
    end
    genre
  end

end

ActiveRecord::Base.transaction do
  FakeDataGeneratorService.new.execute
end